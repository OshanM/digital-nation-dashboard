name: data
on:
  schedule:
    - cron: 0 * * * *
  workflow_dispatch: {}
  push:
    paths:
      - .github/workflows/flat.yml
      - ./process_xlsx.js
jobs:
  scheduled:
    runs-on: ubuntu-latest
    steps:
      - name: Setup deno
        uses: denoland/setup-deno@main
        with:
          deno-version: v1.x
      - name: Check out repo
        uses: actions/checkout@v2
      - name: Fetch data
        uses: githubocto/flat@v2
        if: always()
        with:
           http_url: https://raw.githubusercontent.com/undp/digital-readiness-assessment/main/data/countries_ixp.csv?token=AKK3IXYZ7P7LZQEHQJKKXNTBBVLYG
           downloaded_filename: data/countries_ixp.csv
           postprocess: ./process_raw_data.js

      - name: Fetch data
        uses: githubocto/flat@v2
        if: always()
        with:
           http_url: https://freedomhouse.org/sites/default/files/2020-10/FOTN_2020_Key_Internet_Controls_Updated.xlsx
           downloaded_filename: data/number_key_internet_controls_employed.xlsx
           postprocess: ./process_raw_data.js

      - name: Fetch data
        uses: githubocto/flat@v2
        if: always()
        with:
           http_url: https://development-data-hub-s3-public.s3.amazonaws.com/ddhfiles/94586/wb_id4d_dataset_2018_0.xlsx
           downloaded_filename: data/id4d_nid.xlsx
           postprocess: ./process_raw_data.js

      - name: Fetch data
        uses: githubocto/flat@v2
        if: always()
        with:
           http_url: https://development-data-hub-s3-public.s3.amazonaws.com/ddhfiles/94586/wb_id4d_dataset_2018_0.xlsx
           downloaded_filename: data/id4d_legal.xlsx
           postprocess: ./process_raw_data.js

      - name: Fetch data
        uses: githubocto/flat@v2
        if: always()
        with:
           http_url: https://opencellid.org/ocid/downloads?token=pk.6f7a8f2cfa2bb43ea72428ed4a4b4f47&type=full&file=cell_towers.csv.gz
           downloaded_filename: data/cell_towers_geolocation.csv.gz
           postprocess: ./process_raw_data.js

      - name: Fetch data
        uses: githubocto/flat@v2
        if: always()
        with:
           http_url: https://api.worldbank.org/v2/en/indicator/EG.ELC.ACCS.ZS?downloadformat=excel
           downloaded_filename: data/%_population_electricity_coverage.xls
           postprocess: ./process_raw_data.js

      - name: Fetch data
        uses: githubocto/flat@v2
        if: always()
        with:
           http_url: http://www3.weforum.org/docs/WEF_GCI_4.0_2019_Dataset.xlsx
           downloaded_filename: data/elec_supply_quality.xlsx
           postprocess: ./process_raw_data.js

      - name: Fetch data
        uses: githubocto/flat@v2
        if: always()
        with:
           http_url: https://raw.githubusercontent.com/undp/digital-readiness-assessment/main/data/elec_dist_gride_maps.csv?token=AKK3IXY5XL4426LJTWHZCNTBBVMCI
           downloaded_filename: data/elect_dist_grid_maps.csv
           postprocess: ./process_raw_data.js

      - name: Fetch data
        uses: githubocto/flat@v2
        if: always()
        with:
           http_url: https://www.itu.int/en/ITU-D/Statistics/Documents/statistics/2021/PercentIndividualsUsingInternet.xlsx
           downloaded_filename: data/%_individual_internet_usage.xlsx
           postprocess: ./process_raw_data.js

      - name: Fetch data
        uses: githubocto/flat@v2
        if: always()
        with:
           http_url: https://github.com/undp/digital-readiness-assessment/tree/main/data/tax_%_mobile_ownership.xlsx?raw=true
           downloaded_filename: data/tax_%_mobile_ownership.xlsx
           postprocess: ./process_raw_data.js

      - name: Fetch data
        uses: githubocto/flat@v2
        if: always()
        with:
           http_url: https://docs.google.com/spreadsheets/d/1UC6AuwnX6xu8-fUc9KyActyNXXio6rIST6ga5CQFWLQ/view
           downloaded_filename: data/software_developer_ecosystem_size.xlsx
           postprocess: ./process_raw_data.js

      - name: Fetch data
        uses: githubocto/flat@v2
        if: always()
        with:
           http_url: https://development-data-hub-s3-public.s3.amazonaws.com/ddhfiles/1202896/public_use-talent-migration.xlsx
           downloaded_filename: data/migration_industry.xlsx
           postprocess: ./process_raw_data.js

      - name: Fetch data
        uses: githubocto/flat@v2
        if: always()
        with:
           http_url: https://development-data-hub-s3-public.s3.amazonaws.com/ddhfiles/1202896/public_use-talent-migration.xlsx
           downloaded_filename: data/migration_skill.xlsx
           postprocess: ./process_raw_data.js

      - name: Fetch data
        uses: githubocto/flat@v2
        if: always()
        with:
           http_url: https://development-data-hub-s3-public.s3.amazonaws.com/ddhfiles/1202896/public_use-talent-migration.xlsx
           downloaded_filename: data/migration_country.xlsx
           postprocess: ./process_raw_data.js

      - name: Fetch data
        uses: githubocto/flat@v2
        if: always()
        with:
           http_url: https://stats.oecd.org/SDMX-JSON/data/PATS_COOP/EPO_A+PCT_A+USPTO_A.FOR_APP+FOR_APP_S+FOR_INV+FOR_INV_S+CO_INV+CO_INV_S.AUS+CAN+JPN+NLD+USA+EU27+EU28+WLD.TOTAL+WRD+JPN+USA+EU27+EU28.PRIORITY+APPLICATION/all?startTime=1999&endTime=2019&dimensionAtObservation=allDimensions&pid=0cb10255-1a67-42b2-a2f2-37ecfe3ebbd7
           downloaded_filename: data/international_co_inventions.json
           postprocess: ./process_raw_data.js

      - name: Fetch data
        uses: githubocto/flat@v2
        if: always()
        with:
           http_url: https://www.doingbusiness.org/content/dam/doingBusiness/excel/Historical-data---complete-data-with-scores.xlsx
           downloaded_filename: data/doing_bus_idx.xlsx
           postprocess: ./process_raw_data.js

      - name: Fetch data
        uses: githubocto/flat@v2
        if: always()
        with:
           http_url: http://hdr.undp.org/sites/default/files/2020_statistical_annex_all.xlsx
           downloaded_filename: data/%_population_using_internet.xlsx
           postprocess: ./process_raw_data.js

      - name: Fetch data
        uses: githubocto/flat@v2
        if: always()
        with:
           http_url: https://apimgmtstzgjpfeq2u763lag.blob.core.windows.net/content/MediaLibrary/bdds/SDG.zip
           downloaded_filename: data/sdg_data.zip
           postprocess: ./process_raw_data.js

      - name: Fetch data
        uses: githubocto/flat@v2
        if: always()
        with:
           http_url: http://hdr.undp.org/sites/default/files/2020_statistical_annex_all.xlsx
           downloaded_filename: data/undp_human_developmnt.xlsx
           postprocess: ./process_raw_data.js

      - name: Fetch data
        uses: githubocto/flat@v2
        if: always()
        with:
           http_url: https://data.humdata.org/dataset/e9988552-74e4-4ff4-943f-c782ac8bca87/resource/a9e327cc-d63f-4e61-b13d-d1968ee018bf/download/county_country_aug2020.tsv
           downloaded_filename: data/fb_social_connectedness.tsv
           postprocess: ./process_raw_data.js

      - name: Fetch data
        uses: githubocto/flat@v2
        if: always()
        with:
           http_url: https://development-data-hub-s3-public.s3.amazonaws.com/ddhfiles/140602/country_level_data_0.csv
           downloaded_filename: data/ewaste_per_inhabitant.csv
           postprocess: ./process_raw_data.js

      - name: Fetch data
        uses: githubocto/flat@v2
        if: always()
        with:
           http_url: https://raw.githubusercontent.com/undp/digital-readiness-assessment/main/data/global_wellbeing_initiative%20.csv?token=AKK3IX6UQCPGXLD5JJOLFT3BBVMEE
           downloaded_filename: data/global_wellbeing_initiative .csv
           postprocess: ./process_raw_data.js

      - name: Fetch data
        uses: githubocto/flat@v2
        if: always()
        with:
           http_url: https://databank.worldbank.org/data/download/FINDEX_EXCEL.zip
           downloaded_filename: data/financial_inclusiveness .zip
           postprocess: ./process_raw_data.js

      - name: Fetch data
        uses: githubocto/flat@v2
        if: always()
        with:
           http_url: http://api.worldbank.org/v2/en/indicator/IT.NET.USER.ZS?downloadformat=csv&source=2
           downloaded_filename: data/intenet_usage.csv
           postprocess: ./process_raw_data.js

      - name: Fetch data
        uses: githubocto/flat@v2
        if: always()
        with:
           http_url: https://index.okfn.org/api/datasets.json
           downloaded_filename: data/open_data_idx.json
           postprocess: ./process_raw_data.js

      - name: Fetch data
        uses: githubocto/flat@v2
        if: always()
        with:
           http_url: https://github.com/undp/digital-readiness-assessment/tree/main/data/spectrum_allocated_mobile_providers.xlsx?raw=true
           downloaded_filename: data/spectrum_allocated_mobile_providers.xlsx
           postprocess: ./process_raw_data.js

      - name: Fetch data
        uses: githubocto/flat@v2
        if: always()
        with:
           http_url: https://globalfindex.worldbank.org/sites/globalfindex/files/2018-08/Global%20Findex%20Database.xlsx
           downloaded_filename: data/%_population_digital_financial_services.xlsx
           postprocess: ./process_raw_data.js

      - name: Fetch data
        uses: githubocto/flat@v2
        if: always()
        with:
           http_url: https://unctadstat.unctad.org/7zip/US_IctGoodsShare.csv.7z
           downloaded_filename: data/ict_goods.7z
           postprocess: ./process_raw_data.js

      - name: Fetch data
        uses: githubocto/flat@v2
        if: always()
        with:
           http_url: https://unctadstat.unctad.org/7zip/US_TradeServICT.csv.7z
           downloaded_filename: data/ict_services.7z
           postprocess: ./process_raw_data.js

      - name: Fetch data
        uses: githubocto/flat@v2
        if: always()
        with:
           http_url: https://unstats.un.org/unsd/demographic-social/products/worldswomen/annex_tables/List%20of%20countries%20-%20Table%209.xls
           downloaded_filename: data/list_of_countries.xls
           postprocess: ./process_raw_data.js

      - name: Fetch data
        uses: githubocto/flat@v2
        if: always()
        with:
           http_url: http://hdr.undp.org/sites/default/files/2020_statistical_annex_all.xlsx
           downloaded_filename: data/countries_hdi.xlsx
           postprocess: ./process_raw_data.js

      - name: Fetch data
        uses: githubocto/flat@v2
        if: always()
        with:
           http_url: https://raw.githubusercontent.com/undp/digital-readiness-assessment/main/data/mobile_coverage.csv?token=AKK3IXZJGSYNE2E74QG2EHDBBVMSO
           downloaded_filename: data/mobile_coverage.xls
           postprocess: ./process_raw_data.js

      - name: Fetch data
        uses: githubocto/flat@v2
        if: always()
        with:
           http_url: https://github.com/undp/digital-readiness-assessment/tree/main/data/%25_population_internet_coverage_2g.xlsx?raw=true
           downloaded_filename: data/%_population_internet_coverage_2g.xlsx
           postprocess: ./process_raw_data.js

      - name: Fetch data
        uses: githubocto/flat@v2
        if: always()
        with:
           http_url: https://github.com/undp/digital-readiness-assessment/tree/main/data/%25_population_internet_coverage_3g.xlsx?raw=true
           downloaded_filename: data/%_population_internet_coverage_3g.xlsx
           postprocess: ./process_raw_data.js

      - name: Fetch data
        uses: githubocto/flat@v2
        if: always()
        with:
           http_url: https://github.com/undp/digital-readiness-assessment/tree/main/data/%25_population_internet_coverage_4g.xlsx?raw=true
           downloaded_filename: data/%_population_internet_coverage_4g.xlsx
           postprocess: ./process_raw_data.js

      - name: Fetch data
        uses: githubocto/flat@v2
        if: always()
        with:
           http_url: https://github.com/undp/digital-readiness-assessment/tree/main/data/%25_population_internet_coverage_5g.xlsx?raw=true
           downloaded_filename: data/%_population_internet_coverage_5g.xlsx
           postprocess: ./process_raw_data.js

      - name: Fetch data
        uses: githubocto/flat@v2
        if: always()
        with:
           http_url: https://raw.githubusercontent.com/undp/digital-readiness-assessment/main/data/mobile_broadband_pricing.csv?token=AKK3IX5TEVZ2U6I6CDC3EOTBBVMRQ
           downloaded_filename: data/mobile_broadband_pricing.csv 
           postprocess: ./process_raw_data.js

      - name: Fetch data
        uses: githubocto/flat@v2
        if: always()
        with:
           http_url: https://raw.githubusercontent.com/undp/digital-readiness-assessment/main/data/mob_dev_pen.csv?token=AKK3IX5XX6MUJYZPB45YUFLBBVMQO
           downloaded_filename: data/mob_dev_pen.csv
           postprocess: ./process_raw_data.js

      - name: Fetch data
        uses: githubocto/flat@v2
        if: always()
        with:
           http_url: https://github.com/undp/digital-readiness-assessment/tree/main/data/gender_gap_in_mobile_usage.xlsx?raw=true
           downloaded_filename: data/gender_gap_in_mobile_usage.xlsx
           postprocess: ./process_raw_data.js

      - name: Fetch data
        uses: githubocto/flat@v2
        if: always()
        with:
           http_url: https://raw.githubusercontent.com/undp/digital-readiness-assessment/main/data/ease_doing_bus.csv?token=AKK3IXYKT2DEN2LIZHW3D3DBBVL7A
           downloaded_filename: data/ease_doing_bus.csv
           postprocess: ./process_raw_data.js

      - name: Fetch data
        uses: githubocto/flat@v2
        if: always()
        with:
           http_url: https://raw.githubusercontent.com/undp/digital-readiness-assessment/main/data/time_start_bus.csv?token=AKK3IX5FKWGF6AOUARIHBMDBBVMZE
           downloaded_filename: data/time_start_bus.csv
           postprocess: ./process_raw_data.js

      - name: Fetch data
        uses: githubocto/flat@v2
        if: always()
        with:
           http_url: https://github.com/undp/digital-readiness-assessment/tree/main/data/venture_cap_avail.xlsx?raw=true
           downloaded_filename: data/venture_cap_avail.xlsx
           postprocess: ./process_raw_data.js

      - name: Fetch data
        uses: githubocto/flat@v2
        if: always()
        with:
           http_url: https://raw.githubusercontent.com/undp/digital-readiness-assessment/main/data/b2c_ecommerse_idx.csv?token=AKK3IXY2NOHT7FVMCA5TVYDBBVLSO
           downloaded_filename: data/b2c_ecommerse_idx.csv
           postprocess: ./process_raw_data.js

      - name: Fetch data
        uses: githubocto/flat@v2
        if: always()
        with:
           http_url: https://raw.githubusercontent.com/undp/digital-readiness-assessment/main/data/pop_dens_map.csv?token=AKK3IX7TAGVSAU4Y5YAV4VLBBVMTC
           downloaded_filename: data/pop_dens_map.csv
           postprocess: ./process_raw_data.js

      - name: Fetch data
        uses: githubocto/flat@v2
        if: always()
        with:
           http_url: https://lpi.worldbank.org/sites/default/files/International_LPI_from_2007_to_2018.xlsx
           downloaded_filename: data/countries_lpi.xlsx
           postprocess: ./process_raw_data.js

      - name: Fetch data
        uses: githubocto/flat@v2
        if: always()
        with:
           http_url: https://github.com/undp/digital-readiness-assessment/tree/main/data/countries_gci.xls
           downloaded_filename: data/countries_gci.xls
           postprocess: ./process_raw_data.js

      - name: Fetch data
        uses: githubocto/flat@v2
        if: always()
        with:
           http_url: https://raw.githubusercontent.com/undp/digital-readiness-assessment/main/data/gov_osi.csv?token=AKK3IX2EXUS25P7IKKLB7LTBBVMHG
           downloaded_filename: data/gov_osi.csv
           postprocess: ./process_raw_data.js

      - name: Fetch data
        uses: githubocto/flat@v2
        if: always()
        with:
           http_url: https://raw.githubusercontent.com/undp/digital-readiness-assessment/main/data/countres_epi.csv?token=AKK3IXZG6KYJNHPEPMN6EVLBBVLVS
           downloaded_filename: data/countries_epi.csv
           postprocess: ./process_raw_data.js

      - name: Fetch data
        uses: githubocto/flat@v2
        if: always()
        with:
           http_url: https://github.com/undp/digital-readiness-assessment/blob/main/data/gov_encrypted_traffic.csv.zip?raw=true
           downloaded_filename: data/gov_encrypted_traffic.zip
           postprocess: ./process_raw_data.js

      - name: Fetch data
        uses: githubocto/flat@v2
        if: always()
        with:
           http_url: https://unctad.org/system/files/information-document/DP.xlsx
           downloaded_filename: data/glob_data_priv_law.xlsx
           postprocess: ./process_raw_data.js

      - name: Fetch data
        uses: githubocto/flat@v2
        if: always()
        with:
           http_url: https://github.com/undp/digital-readiness-assessment/tree/main/data/countries_mobile_connectivity.xlsx?raw=true
           downloaded_filename: data/countries_mobile_connectivity.xlsx
           postprocess: ./process_raw_data.js

      - name: Fetch data
        uses: githubocto/flat@v2
        if: always()
        with:
           http_url: https://www.schneier.com/cryptography/paperfiles/worldwide-encryption-product-survey-data.xls
           downloaded_filename: data/encrytion_data.xlsx
           postprocess: ./process_raw_data.js

      - name: Fetch data
        uses: githubocto/flat@v2
        if: always()
        with:
           http_url: https://raw.githubusercontent.com/undp/digital-readiness-assessment/main/data/rli.csv?token=AKK3IXYCHVZO6E4MUU4K57LBBVMU4
           downloaded_filename: data/rli.csv
           postprocess: ./process_raw_data.js

      - name: Fetch data
        uses: githubocto/flat@v2
        if: always()
        with:
           http_url: https://databank.worldbank.org/data/download/HCI_csv.zip
           downloaded_filename: data/countries_hci.zip
           postprocess: ./process_raw_data.js

      - name: Fetch data
        uses: githubocto/flat@v2
        if: always()
        with:
           http_url: time_start_bus
           downloaded_filename: data/sci.csv
           postprocess: ./process_raw_data.js

      - name: Fetch data
        uses: githubocto/flat@v2
        if: always()
        with:
           http_url: https://raw.githubusercontent.com/undp/digital-readiness-assessment/main/data/top_sites.csv?token=AKK3IX5BB6NO25ANF2FAXADBBVM2S
           downloaded_filename: data/top_sites.csv
           postprocess: ./process_raw_data.js

      - name: Fetch data
        uses: githubocto/flat@v2
        if: always()
        with:
           http_url: https://github.com/undp/digital-readiness-assessment/tree/main/data/google_trends.xlsx?raw=true
           downloaded_filename: data/google_trends.xlsx
           postprocess: ./process_raw_data.js

      - name: Fetch data
        uses: githubocto/flat@v2
        if: always()
        with:
           http_url: https://raw.githubusercontent.com/undp/digital-readiness-assessment/main/data/youtube_searches.csv?token=AKK3IXYYEFLEK5WDW6DZ2FLBBVM3K
           downloaded_filename: data/youtube_searches.csv
           postprocess: ./process_raw_data.js

      - name: Fetch data
        uses: githubocto/flat@v2
        if: always()
        with:
           http_url: https://www.itu.int/en/ITU-D/Statistics/Documents/statistics/2020/MobileCellularSubscriptions_2000-2019.xlsx
           downloaded_filename: data/%_mobile_cell_sub.xlsx
           postprocess: ./process_raw_data.js

      - name: Fetch data
        uses: githubocto/flat@v2
        if: always()
        with:
           http_url: https://energydata.info/dataset/12c85425-14be-430b-ad72-c68804c49e8e/resource/dcda6530-8d2c-436e-9d1d-1e2809ad303e/download/enerdata_energy_statistical_yearbook_2018.xlsx
           downloaded_filename: data/electricity_yearbook.xlsx
           postprocess: ./process_raw_data.js

      - name: Fetch data
        uses: githubocto/flat@v2
        if: always()
        with:
           http_url: https://www.itu.int/en/ITU-D/Statistics/Documents/facts/ITU_regional_global_Key_ICT_indicator_aggregates_Nov_2020.xlsx
           downloaded_filename: data/tii_countries.xlsx
           postprocess: ./process_raw_data.js

      - name: Fetch data
        uses: githubocto/flat@v2
        if: always()
        with:
           http_url: https://datahub.io/world-bank/tx.val.tech.cd/r/data.csv
           downloaded_filename: data/tech_hubs.csv
           postprocess: ./process_raw_data.js

      - name: Fetch data
        uses: githubocto/flat@v2
        if: always()
        with:
           http_url: https://raw.githubusercontent.com/undp/digital-readiness-assessment/main/data/legal_rights_strength.csv?token=AKK3IXZ2KR7JKRSKCY57A2TBBVMMA
           downloaded_filename: data/legal_rights_strength.csv
           postprocess: ./process_raw_data.js

      - name: Fetch data
        uses: githubocto/flat@v2
        if: always()
        with:
           http_url: https://microdata.worldbank.org/index.php/metadata/export/1533/json
           downloaded_filename: data/postal_coverage.json
           postprocess: ./process_raw_data.js

      - name: Fetch data
        uses: githubocto/flat@v2
        if: always()
        with:
           http_url: https://nces.ed.gov/programs/digest/d18/tables/xls/tabn218.10.xls
           downloaded_filename: data/school_w_internet.xls
           postprocess: ./process_raw_data.js

      - name: Fetch data
        uses: githubocto/flat@v2
        if: always()
        with:
           http_url: 
           downloaded_filename: data/dice_export_global_cybersecurity_index (1).csv
           postprocess: ./process_raw_data.js

      - name: Fetch data
        uses: githubocto/flat@v2
        if: always()
        with:
           http_url: 
           downloaded_filename: data/ecosystem.csv
           postprocess: ./process_raw_data.js
